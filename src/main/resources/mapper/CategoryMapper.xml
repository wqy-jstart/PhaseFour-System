<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.tedu.csmall.product.mapper.CategoryMapper">

    <!--int insert(Category category);-->
    <insert id="insert" useGeneratedKeys="true" keyProperty="id">
        INSERT INTO pms_category(name, parent_id, depth, keywords, sort, icon, enable, is_parent, is_display)
        VALUES (#{name}, #{parentId}, #{depth}, #{keywords}, #{sort},
                #{icon}, #{enable}, #{isParent}, #{isDisplay})
    </insert>

    <!--int insertBatch(List<Category> categories);-->
    <insert id="insertBatch" useGeneratedKeys="true" keyProperty="id">
        INSERT INTO pms_category(
        name,parent_id,depth,keywords,sort,icon,enable,is_parent,is_display
        )VALUES
        <foreach collection="list" item="category" separator=",">
            (#{category.name},#{category.parentId},#{category.depth},#{category.keywords},
            #{category.sort},#{category.icon},#{category.enable},#{category.isParent},#{category.isDisplay})
        </foreach>
    </insert>

    <!--int deleteById(Long id);-->
    <delete id="deleteById">
        DELETE
        FROM pms_category
        WHERE id = #{id}
    </delete>

    <!--int deleteByIds(Long[] ids);-->
    <delete id="deleteByIds">
        DELETE FROM pms_category WHERE id IN
        (
        <foreach collection="array" item="id" separator=",">
            #{id}
        </foreach>
        )
    </delete>

    <!--int update(Category category);-->
    <update id="update">
        UPDATE pms_category
        <set>
            <if test="name!=null">name=#{name},</if>
            <if test="parentId!=null">parent_id=#{parentId},</if>
            <if test="depth!=null">depth=#{depth},</if>
            <if test="keywords!=null">keywords=#{keywords},</if>
            <if test="sort!=null">sort=#{sort},</if>
            <if test="icon!=null">icon=#{icon},</if>
            <if test="enable!=null">enable=#{enable},</if>
            <if test="isParent!=null">is_parent=#{isParent},</if>
            <if test="isDisplay!=null">is_display=#{isDisplay},</if>
        </set>
        WHERE id=#{id}
    </update>

    <!--int count();-->
    <select id="count" resultType="int">
        SELECT count(*)
        FROM pms_category
    </select>

    <!--int countByName(String name);-->
    <select id="countByName" resultType="int">
        SELECT count(*) FROM pms_category WHERE name=#{name}
    </select>

    <!--CategoryStandardVO getStandardById(Long id);-->
    <select id="getStandardById" resultMap="StandardResultMapper">
        SELECT 
        <include refid="StandardQueryFields"></include>
        FROM pms_category
        WHERE id = #{id}
    </select>
    <resultMap id="StandardResultMapper" type="cn.tedu.csmall.product.pojo.vo.CategoryStandardVO">
        <id column="id" property="id"></id>
        <result column="name" property="name"></result>
        <result column="parent_id" property="parentId"></result>
        <result column="depth" property="depth"></result>
        <result column="keywords" property="keywords"></result>
        <result column="sort" property="sort"></result>
        <result column="icon" property="icon"></result>
        <result column="enable" property="enable"></result>
        <result column="is_parent" property="isParent"></result>
        <result column="is_display" property="isDisplay"></result>
    </resultMap>

    <!--List<CategoryListItemVO> list();-->
    <select id="list" resultMap="ListResultMapper">
        SELECT
        <include refid="StandardQueryFields"></include>
        FROM pms_category
        ORDER BY sort DESC, id DESC
    </select>
    <resultMap id="ListResultMapper" type="cn.tedu.csmall.product.pojo.vo.CategoryListItemVO">
        <id column="id" property="id"></id>
        <result column="name" property="name"></result>
        <result column="parent_id" property="parentId"></result>
        <result column="depth" property="depth"></result>
        <result column="keywords" property="keywords"></result>
        <result column="sort" property="sort"></result>
        <result column="icon" property="icon"></result>
        <result column="enable" property="enable"></result>
        <result column="is_parent" property="isParent"></result>
        <result column="is_display" property="isDisplay"></result>
    </resultMap>

    <sql id="StandardQueryFields">
        <if test="true">
            id,
            name,
            parent_id,
            depth,
            keywords,
            sort,
            icon,
            enable,
            is_parent,
            is_display
        </if>
    </sql>

</mapper>
